<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quotation Tool | Mambakkadan's Steels & Cements</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        navy: {
                            100: '#E6E9F0',
                            500: '#2A4365', // Navy
                            600: '#233852',
                            900: '#1A2C42' // Very dark navy
                        },
                        gold: {
                            300: '#E9D5A3', // Gold
                            500: '#C9A55B' // Rich gold
                        }
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f7f9fc; }
        .card { background: white; border-radius: 16px; border: 1px solid #e1e8f0; }
        input, select { border: 2px solid #e2e8f0 !important; }
        input:focus, select:focus { border-color: #2A4365 !important; ring: 0; outline: 0;}
    </style>
</head>
<body class="p-3 md:p-8">

    <div class="max-w-4xl mx-auto mb-10 text-center border-b-2 border-slate-200 pb-8">
        <h1 class="text-4xl font-extrabold text-navy-900 tracking-tighter">MAMBAKKADAN'S STEELS & CEMENTS</h1>
        <p class="text-gold-500 font-bold italic text-xl">Strength you can Build on.</p>
        <div class="mt-2 text-xs text-slate-400 uppercase tracking-widest">[ Internal Quotation System ]</div>
    </div>

    <div class="max-w-4xl mx-auto space-y-6">
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="card p-6 border-l-8 border-navy-500 bg-white">
                <h2 class="font-bold text-navy-500 mb-4 flex items-center gap-2 text-sm uppercase tracking-wider">ðŸ’° Today's Rates (â‚¹/kg)</h2>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="text-xs font-bold text-slate-500 uppercase">GP Steel</label>
                        <input type="number" id="gpRate" value="86" class="w-full p-3 rounded-lg bg-navy-100 font-bold text-lg text-navy-900">
                    </div>
                    <div>
                        <label class="text-xs font-bold text-slate-500 uppercase">GI Pipes (B)</label>
                        <input type="number" id="giRate" value="95" class="w-full p-3 rounded-lg bg-navy-100 font-bold text-lg text-navy-900">
                    </div>
                </div>
            </div>
            <div class="card p-6 border-l-8 border-gold-500 bg-white">
                <h2 class="font-bold text-navy-500 mb-4 text-sm uppercase tracking-wider">ðŸ‘¤ Customer Details</h2>
                <input type="text" id="custName" placeholder="Client Name or Walk-in" class="w-full p-3 rounded-lg bg-slate-50">
            </div>
        </div>

        <div class="card p-8 bg-white">
            <h2 class="font-bold text-navy-500 mb-6 text-sm uppercase tracking-wider">Quick Product Select</h2>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                <div class="md:col-span-4">
                    <label class="text-xs font-bold text-slate-500 uppercase">Select Item (Grade B for GI)</label>
                    <select id="productSelect" class="w-full p-4 rounded-xl mt-1 text-xl bg-slate-50" onchange="handleProductChange()">
                        </select>
                </div>
                <div id="gaugeBox" class="md:col-span-2">
                    <label class="text-xs font-bold text-slate-500 uppercase">Select Gauge</label>
                    <select id="gaugeSelect" class="w-full p-4 rounded-xl mt-1 text-xl bg-gold-300">
                        <option value="16">16 Gauge</option>
                        <option value="18">18 Gauge</option>
                    </select>
                </div>
                <div class="md:col-span-2">
                    <label class="text-xs font-bold text-slate-500 uppercase">Qty (Nos)</label>
                    <input type="number" id="itemQty" value="1" min="1" class="w-full p-4 rounded-xl mt-1 text-xl font-black bg-slate-50">
                </div>
                <div class="md:col-span-4 flex items-end">
                    <button onclick="addItem()" class="w-full bg-navy-900 text-gold-300 font-black py-4 rounded-xl hover:bg-navy-600 transition shadow-lg text-lg uppercase tracking-wider">
                        + Add to Quotation
                    </button>
                </div>
            </div>
        </div>

        <div class="card overflow-hidden">
            <div class="p-5 bg-navy-900 border-b flex justify-between items-center">
                <span class="font-bold text-gold-300 uppercase tracking-wider text-sm">Quotation Details</span>
                <span id="dateDisplay" class="text-slate-200 text-sm font-medium"></span>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full text-left border-collapse">
                    <thead>
                        <tr class="bg-navy-100 text-navy-500 text-[11px] uppercase tracking-widest border-b">
                            <th class="p-5">Product (Size)</th>
                            <th class="p-5 text-center">Wt/No</th>
                            <th class="p-5 text-center">Qty</th>
                            <th class="p-5 text-right">Total (INR)</th>
                            <th class="p-5"></th>
                        </tr>
                    </thead>
                    <tbody id="quoteBody" class="text-sm">
                        </tbody>
                </table>
            </div>
            
            <div id="emptyMsg" class="p-16 text-center text-slate-400 italic font-medium">Add products above to get started.</div>
            
            <div class="p-8 border-t bg-navy-100 flex flex-col md:flex-row justify-between items-center gap-6">
                <div class="text-center md:text-left">
                    <span class="text-navy-500 uppercase text-xs font-bold tracking-widest">Grand Total</span>
                    <div class="text-4xl font-black text-navy-900">â‚¹ <span id="grandTotal text-blue-600">0.00</span></div>
                </div>
                <button onclick="generatePDF()" class="w-full md:w-auto bg-gold-500 text-white px-10 py-5 rounded-2xl font-black shadow-2xl hover:bg-gold-300 flex items-center justify-center gap-2 text-xl uppercase tracking-wider">
                    ðŸ“¥ DOWNLOAD PDF
                </button>
            </div>
        </div>
    </div>

    <script>
        const products = [
            // GP SQUARE/RECT
            { name: '1/2" * 1/2" GP (16x16mm)', cat: 'gp', g16: 4, g18: 3.2 },
            { name: '3/4" * 3/4" GP (20x20mm)', cat: 'gp', g16: 5, g18: 4 },
            { name: '1" * 1" GP (25x25mm)', cat: 'gp', g16: 6, g18: 5.2 },
            { name: '1 1/4" * 1 1/4" GP (32x32mm)', cat: 'gp', g16: 8, g18: null },
            { name: '1 1/2" * 1 1/2" GP (40x40mm)', cat: 'gp', g16: 10, g18: null },
            { name: '2" * 2" GP (50x50mm)', cat: 'gp', g16: 12.6, g18: null },
            { name: '3" * 3" GP (75x75mm)', cat: 'gp', g16: 19, g18: null },
            { name: '4" * 4" GP (100x100mm)', cat: 'gp', g16: 26, g18: null },
            { name: '1" * 10" GP (25x10mm)', cat: 'gp', g16: 5, g18: null },
            { name: '1 1/2" * 10" GP (40x10mm)', cat: 'gp', g16: 6.2, g18: null },
            { name: '1 1/2" * 3/4" GP (40x20mm)', cat: 'gp', g16: 7.6, g18: null },
            { name: '2" * 1" GP (50x25mm)', cat: 'gp', g16: 9.6, g18: 8.5 },
            { name: '2 1/2" * 1 1/2" GP (60x40mm)', cat: 'gp', g16: 12.6, g18: 12.5 },
            { name: '3" * 1" GP (75x25mm)', cat: 'gp', g16: 12.6, g18: 11 },
            { name: '3" * 1 1/2" GP (80x40mm)', cat: 'gp', g16: 15.2, g18: 12.8 },
            { name: '4" * 1" GP (100x25mm)', cat: 'gp', g16: 15.2, g18: null },
            { name: '4" * 2" GP (100x50mm)', cat: 'gp', g16: 19, g18: null },
            // GP ROUND
            { name: '1" Round GP', cat: 'gp', g16: 6, g18: null },
            { name: '1 1/4" Round GP', cat: 'gp', g16: 7.9, g18: null },
            { name: '1 1/2" Round GP', cat: 'gp', g16: 9.9, g18: null },
            { name: '2" Round GP', cat: 'gp', g16: 12.5, g18: null },
            { name: '2 1/2" Round GP', cat: 'gp', g16: 14.5, g18: null },
            { name: '3" Round GP', cat: 'gp', g16: 20.5, g18: null },
            // GI ROUND (Grade B)
            { name: '1/2" Round GI', cat: 'gi', weight: 0 },
            { name: '3/4" Round GI', cat: 'gi', weight: 7.9 },
            { name: '1" Round GI', cat: 'gi', weight: 9.8 },
            { name: '1 1/4" Round GI', cat: 'gi', weight: 12.4 },
            { name: '1 1/2" Round GI', cat: 'gi', weight: 14.4 },
            { name: '2" Round GI', cat: 'gi', weight: 18 },
            { name: '2 1/2" Round GI', cat: 'gi', weight: 22.9 },
            { name: '3" Round GI', cat: 'gi', weight: 26 },
            { name: '3 1/2" Round GI', cat: 'gi', weight: 32 },
            { name: '4" Round GI', cat: 'gi', weight: 34 },
            { name: '5" Round GI', cat: 'gi', weight: 45.3 }
        ];

        let quoteList = [];

        function init() {
            document.getElementById('dateDisplay').innerText = new Date().toLocaleDateString('en-IN', { day:'numeric', month:'short', year:'numeric'});
            const select = document.getElementById('productSelect');
            products.forEach((p, index) => {
                let opt = document.createElement('option');
                opt.value = index;
                opt.innerHTML = p.name;
                select.appendChild(opt);
            });
            handleProductChange();
        }

        function handleProductChange() {
            const p = products[document.getElementById('productSelect').value];
            const gBox = document.getElementById('gaugeBox');
            gBox.style.display = (p.cat === 'gp' && p.g18) ? 'block' : 'none';
        }

        function addItem() {
            const pIdx = document.getElementById('productSelect').value;
            const p = products[pIdx];
            const qty = parseFloat(document.getElementById('itemQty').value);
            const rate = p.cat === 'gp' ? parseFloat(document.getElementById('gpRate').value) : parseFloat(document.getElementById('giRate').value);
            
            let weight = p.weight;
            let label = p.name;
            
            if(p.cat === 'gp') {
                if(p.g18) {
                    const g = document.getElementById('gaugeSelect').value;
                    weight = g === "16" ? p.g16 : p.g18;
                    label += ` (${g} Gauge)`;
                } else {
                    weight = p.g16;
                    label += ` (16 Gauge)`;
                }
            } else {
                label += ` (Grade B)`;
            }

            const totalWeight = weight * qty;
            const totalPrice = totalWeight * rate;

            quoteList.push({ desc: label, unitWt: weight, qty: qty, rate: rate, total: totalPrice });
            renderTable();
        }

        function renderTable() {
            const body = document.getElementById('quoteBody');
            const empty = document.getElementById('emptyMsg');
            body.innerHTML = "";
            let grand = 0;

            if(quoteList.length > 0) empty.style.display = 'none';

            quoteList.forEach((item, index) => {
                grand += item.total;
                body.innerHTML += `
                    <tr class="border-b bg-white hover:bg-navy-100/50">
                        <td class="p-5 font-semibold text-navy-900">${item.desc}</td>
                        <td class="p-5 text-center text-slate-500">${item.unitWt} kg</td>
                        <td class="p-5 text-center font-bold">${item.qty}</td>
                        <td class="p-5 text-right font-bold text-navy-900">â‚¹${item.total.toLocaleString('en-IN')}</td>
                        <td class="p-5 text-center"><button onclick="removeItem(${index})" class="text-red-400 font-bold hover:text-red-600">âœ•</button></td>
                    </tr>
                `;
            });
            document.getElementById('grandTotal').innerText = grand.toLocaleString('en-IN', {minimumFractionDigits: 2});
        }

        function removeItem(i) {
            quoteList.splice(i, 1);
            renderTable();
        }

        function generatePDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Professional Branding (PDF version)
            doc.setFont("helvetica", "bold");
            doc.setFontSize(22);
            doc.setTextColor(26, 44, 66); // Navy 900
            doc.text("MAMBAKKADAN'S STEELS & CEMENTS", 105, 20, null, null, "center");
            
            doc.setFontSize(10);
            doc.setFont("helvetica", "italic");
            doc.setTextColor(201, 165, 91); // Gold 500
            doc.text("Strength you can Build on.", 105, 26, null, null, "center");
            
            doc.setDrawColor(200);
            doc.line(20, 32, 190, 32);

            // Customer Info (PDF)
            doc.setFont("helvetica", "normal");
            doc.setTextColor(40);
            doc.setFontSize(11);
            doc.text(`Customer: ${document.getElementById('custName').value || 'Valued Customer'}`, 20, 42);
            doc.text(`Date: ${new Date().toLocaleDateString()}`, 190, 42, null, null, "right");

            const tableData = quoteList.map(i => [i.desc, i.unitWt + " kg", i.qty, i.rate, i.total.toFixed(2)]);
            
            // Navy/Gold Themed PDF Table
            doc.autoTable({
                startY: 50,
                head: [['Product Description', 'Wt/No', 'Qty', 'Rate (kg)', 'Total (INR)']],
                body: tableData,
                headStyles: { fillColor: [26, 44, 66], textColor: [201, 165, 91], fontSize: 10, halign: 'center' }, // Navy Head, Gold Text
                styles: { fontSize: 9, cellPadding: 4, halign: 'center' },
                columnStyles: { 0: { halign: 'left', fontStyle: 'bold' }, 4: { halign: 'right' } } // Format First and Last columns
            });

            const finalY = doc.lastAutoTable.finalY + 15;
            doc.setFontSize(16);
            doc.setFont("helvetica", "bold");
            doc.text(`Grand Total: Rs. ${document.getElementById('grandTotal').innerText}`, 190, finalY, null, null, "right");

            doc.save(`Quotation_${new Date().toLocaleDateString()}.pdf`);
        }

        window.onload = init;
    </script>
</body>
</html>